#!/usr/bin/python

# This creates the level1 fsf's and the script to run the feats on condor

import os
import glob

studydir = '/home/lauryn/Documents/FCTM_S/MRI_Data/Analyses'

fsfdir="%s/group/models/fsfA/lvl2"%(studydir)


subdirs=glob.glob("%s/1[0-9][0-9][0-9][0-9]"%(studydir))


for dir in list(subdirs):
  splitdir = dir.split('/')
  splitdir_sub = splitdir[7]  # You will need to edit this
  subnum=splitdir_sub[-5:]    # You also may need to edit this
  subfeats=glob.glob("%s/model/A_task_[0-9].feat"%(dir))
  if len(subfeats)==6:  # Add your own second loop for 2 feat cases
    print(subnum)
    replacements = {'17271':subnum}
    with open("%s/lvl2.fsf"%(fsfdir)) as infile: 
      with open("%s/A_task-lvl2fe-TEMP%s.fsf"%(fsfdir, subnum), 'w') as outfile:
          for line in infile:
            for src, target in replacements.iteritems():
              line = line.replace(src, target)
            outfile.write(line)
    
